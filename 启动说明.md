# 一键启动脚本使用说明

## 📋 脚本说明

本项目提供了一键启动前后端服务的脚本，支持Windows和Linux/Mac系统。

### 脚本文件

- **Windows系统**：
  - `start.bat` - 一键启动前后端服务
  - `stop.bat` - 停止所有服务

- **Linux/Mac系统**：
  - `start.sh` - 一键启动前后端服务
  - `stop.sh` - 停止所有服务

## 🚀 使用方法

### Windows系统

1. **启动服务**：
   ```bash
   # 双击运行或在命令行执行
   start.bat
   ```

2. **停止服务**：
   ```bash
   # 双击运行或在命令行执行
   stop.bat
   ```

### Linux/Mac系统

1. **启动服务**：
   ```bash
   # 首次使用需要添加执行权限
   chmod +x start.sh stop.sh
   
   # 启动服务
   ./start.sh
   ```

2. **停止服务**：
   ```bash
   ./stop.sh
   ```

## 📦 环境要求

### 必需环境

- **Java**: JDK 1.8 或更高版本
- **Node.js**: 建议使用 Node.js 14.x 或更高版本
- **npm**: 通常随 Node.js 一起安装

### 可选环境

- **Maven**: 如果已安装Maven，将使用Maven启动后端；否则使用jar包启动

## 🔍 脚本功能

### start.bat / start.sh

1. **环境检测**：
   - ✅ 检查Java环境
   - ✅ 检查Maven环境（可选）
   - ✅ 检查Node.js环境
   - ✅ 检查npm环境

2. **依赖检查**：
   - ✅ 检查前端依赖（node_modules）
   - ✅ 如果未安装，自动执行 `npm install`

3. **服务启动**：
   - ✅ 启动后端服务（端口：8081）
     - 优先使用Maven启动：`mvn spring-boot:run`
     - 如果没有Maven，使用jar包启动
   - ✅ 启动前端服务（默认端口：80）
     - 执行：`npm run dev`

4. **状态检查**：
   - ✅ 等待后端启动（30秒）
   - ✅ 检查后端服务状态
   - ✅ 显示服务访问地址

### stop.bat / stop.sh

1. **服务停止**：
   - ✅ 查找并停止后端服务进程
   - ✅ 查找并停止前端服务进程
   - ✅ 清理PID文件

## 📝 使用示例

### Windows示例

```bash
# 启动服务
C:\project> start.bat

# 输出示例：
========================================
  AR/VR数字孪生管理系统 - 一键启动
========================================

[1/4] 检查Java环境...
[成功] Java环境检测通过

[2/4] 检查Maven环境...
[成功] Maven环境检测通过

[3/4] 检查Node.js环境...
[成功] Node.js环境检测通过

[4/4] 检查前端依赖...
[成功] 前端依赖已存在

========================================
  正在启动后端服务...
========================================

[提示] 使用Maven启动后端...
[提示] 等待后端服务启动（约30秒）...
[成功] 后端服务启动成功！访问地址: http://localhost:8081

========================================
  正在启动前端服务...
========================================

========================================
  启动完成！
========================================

后端服务地址: http://localhost:8081
前端服务地址: http://localhost:80
```

### Linux/Mac示例

```bash
# 启动服务
$ ./start.sh

# 输出示例：
========================================
  AR/VR数字孪生管理系统 - 一键启动
========================================

[1/4] 检查Java环境...
[成功] Java环境检测通过

[2/4] 检查Maven环境...
[成功] Maven环境检测通过

[3/4] 检查Node.js环境...
[成功] Node.js环境检测通过

[4/4] 检查前端依赖...
[成功] 前端依赖已存在

========================================
  正在启动后端服务...
========================================

[提示] 使用Maven启动后端...
[成功] 后端服务已启动，PID: 12345

[提示] 等待后端服务启动（约30秒）...
[成功] 后端服务启动成功！访问地址: http://localhost:8081

========================================
  正在启动前端服务...
========================================

[成功] 前端服务已启动，PID: 12346

========================================
  启动完成！
========================================

后端服务地址: http://localhost:8081
前端服务地址: http://localhost:80

提示: 
  - 后端PID: 12345 (保存在 ruoyi-admin/backend.pid)
  - 前端PID: 12346 (保存在 frontend.pid)
  - 后端日志: ruoyi-admin/logs/backend.log
  - 前端日志: logs/frontend.log
  - 停止服务: ./stop.sh 或 kill 12345 12346
```

## 🛠️ 故障排查

### 问题1：Java环境未检测到

**解决方案**：
- 确保已安装JDK 1.8或更高版本
- 检查JAVA_HOME环境变量是否配置
- Windows：在系统环境变量中添加Java路径
- Linux/Mac：使用 `which java` 检查Java路径

### 问题2：Node.js环境未检测到

**解决方案**：
- 安装Node.js：https://nodejs.org/
- 检查PATH环境变量是否包含Node.js路径
- 使用 `node -v` 和 `npm -v` 验证安装

### 问题3：前端依赖安装失败

**解决方案**：
- 检查网络连接
- 尝试使用国内镜像：
  ```bash
  npm config set registry https://registry.npmmirror.com
  ```
- 手动执行：`cd ruoyi-ui && npm install`

### 问题4：后端启动失败

**解决方案**：
- 检查端口8081是否被占用：
  - Windows: `netstat -ano | findstr :8081`
  - Linux/Mac: `lsof -i :8081`
- 检查数据库连接配置（application.yml）
- 查看后端日志：`ruoyi-admin/logs/backend.log`

### 问题5：前端启动失败

**解决方案**：
- 检查前端端口是否被占用
- 查看前端日志：`logs/frontend.log`
- 尝试手动启动：`cd ruoyi-ui && npm run dev`

### 问题6：服务无法停止

**解决方案**：
- Windows：打开任务管理器，手动结束相关进程
- Linux/Mac：使用 `ps aux | grep java` 查找进程，然后 `kill -9 PID`

## 📌 注意事项

1. **首次启动**：
   - 前端依赖会自动安装，可能需要几分钟时间
   - 后端首次启动可能需要编译，请耐心等待

2. **端口占用**：
   - 后端默认端口：8081
   - 前端默认端口：80（可在vue.config.js中修改）
   - 如果端口被占用，请先停止占用端口的程序

3. **日志查看**：
   - 后端日志：`ruoyi-admin/logs/backend.log`
   - 前端日志：`logs/frontend.log`
   - Windows：日志在独立窗口中显示
   - Linux/Mac：使用 `tail -f` 查看实时日志

4. **服务停止**：
   - Windows：关闭对应的命令行窗口即可停止服务
   - Linux/Mac：使用 `./stop.sh` 或手动kill进程

5. **开发模式**：
   - 脚本启动的是开发模式
   - 生产环境部署请使用打包后的jar包和前端dist目录

## 🔗 相关链接

- 后端服务：http://localhost:8081
- 前端服务：http://localhost:80
- Swagger文档：http://localhost:8081/swagger-ui.html（如果启用）

---

**提示**：如有问题，请查看日志文件或联系开发团队。

